<?php
namespace App\Filament\Resources\Patients\RelationManagers;use Filament\Forms\Components\DatePicker;use Filament\Forms\Components\Select;use Filament\Forms\Components\Textarea;use Filament\Resources\RelationManagers\RelationManager;use Filament\Schemas\Schema;use Filament\Tables;use Filament\Tables\Columns\TextColumn;use Filament\Tables\Table;use Illuminate\Database\Eloquent\Builder;class DiseasesRelationManager extends RelationManager{protected static string $relationship='diseases';public function form(Schema $schema): Schema{return $schema->components([DatePicker::make('diagnosed_at')->label('Fecha diagnóstico'),Select::make('status')->label('Estado')->options(['confirmed'=>'Confirmada','suspected'=>'Sospechada','resolved'=>'Resuelta'])->required(),Textarea::make('notes')->label('Notas')->columnSpanFull(),]);}public function table(Table $table): Table{return $table->recordTitleAttribute('name')->columns([TextColumn::make('name')->label('Enfermedad')->searchable(),TextColumn::make('pivot.diagnosed_at')->label('Diagnóstico')->date(),TextColumn::make('pivot.status')->label('Estado')->badge(),])->headerActions([Tables\Actions\AttachAction::make()->label('Asociar enfermedad')->preloadRecordSelect()->recordSelectSearchable()->recordSelectOptionsQuery(fn(Builder $q)=>$q->where('active',true))->fields([DatePicker::make('diagnosed_at')->label('Fecha diagnóstico'),Select::make('status')->label('Estado')->options(['confirmed'=>'Confirmada','suspected'=>'Sospechada','resolved'=>'Resuelta'])->required(),Textarea::make('notes')->label('Notas')->columnSpanFull(),]),])->recordActions([Tables\Actions\DetachAction::make(),Tables\Actions\EditAction::make(),])->bulkActions([Tables\Actions\BulkActionGroup::make([Tables\Actions\DetachBulkAction::make(),]),]);}}